<?php

class ExploitationModel extends Model
{
    public function getConsoMoyenne()
    {
        $req = $this->getDb()->prepare('SELECT
        type,
        ROUND((SUM(litreConso) / SUM(distanceKm)) * 100, 2) AS `consommation_moyenne`
    FROM
        `conso_vehicules`
    WHERE
        `anneeConso` = 2023 AND distanceKm <> 0
    GROUP BY
        type;
    ');
         $req->execute();
        // Récupérer les résultats sous forme de tableau associatif
      $data = $req->fetchAll(PDO::FETCH_ASSOC);
      return $data;  
    }

    public function getConsoMoyenneElever()
    {
      $req = $this->getDb()->prepare('SELECT
      immatVehicule,
      ROUND(AVG(distanceKm), 3) AS consommation_moyenne_arrondie
  FROM
      conso_vehicules
  WHERE
      (distanceKm) IS NOT NULL
  GROUP BY
      immatVehicule
  ORDER BY
      consommation_moyenne_arrondie DESC
  LIMIT 10;
  ');
       $req->execute();
      // Récupérer les résultats sous forme de tableau associatif
    $dataConsommationElever = $req->fetchAll(PDO::FETCH_ASSOC);
    return $dataConsommationElever;
    }

    

  
}

