<?php

class ExploitationModel extends Model
{
    public function getConsoMoyenne()
    {
        $req = $this->getDb()->prepare('SELECT type, (litreConso / distanceKm) AS `consommation_moyenne`
        FROM `conso_vehicules`
        WHERE `moisConso` = 1 AND `anneeConso` = 2023 AND (`litreConso` / `distanceKm`) IS NOT NULL
        ORDER BY `consommation_moyenne` DESC
        LIMIT 20');
         $req->execute();
        // Récupérer les résultats sous forme de tableau associatif
      $data = $req->fetchAll(PDO::FETCH_ASSOC);
      return $data;  
    }

    public function getConsoMoyenneElever()
    {
      $req = $this->getDb()->prepare('SELECT
      immatVehicule,
      ROUND(AVG(litreConso / distanceKm), 3) AS consommation_moyenne_arrondie
  FROM
      conso_vehicules
  WHERE
      (litreConso / distanceKm) IS NOT NULL
  GROUP BY
      immatVehicule
  ORDER BY
      consommation_moyenne_arrondie DESC
  LIMIT 10;
  ');
       $req->execute();
      // Récupérer les résultats sous forme de tableau associatif
    $dataConsommationElever = $req->fetchAll(PDO::FETCH_ASSOC);
    return $dataConsommationElever;
    }

    

  
}

